<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atlas.dao.CatDAO">
    <select id="recommend" resultType="Cat">
        select * from cat order by rand() limit 10
    </select>

    <select id="catdetail" parameterType="Picture" resultType="Cat">
        select c.*,p.* from cat c,picture p where pid=#{pid} and p.cid=c.cid
    </select>

    <select id="search" parameterType="Picture" resultType="Cat">
        select * from cat where name like concat('%',#{information},'%')
                        or color like concat('%',#{information},'%')
                        or place like concat('%',#{information},'%')
    </select>

    <resultMap id="gbcolor" type="com.atlas.entity.Cat">
        <id property="color" column="color"></id>
        <result property="color" column="color"></result>
        <result property="cid" column="cid"></result>
        <collection property="catList" ofType="com.atlas.entity.Cat">
            <result property="name" column="name"></result>
            <collection property="picture" select="findpicture" column="cid"></collection>
        </collection>
    </resultMap>

    <select id="findpicture" resultType="Picture">
        select * from picture where cid=#{cid} order by rand() limit 1
    </select>

    <select id="findall" resultMap="gbcolor">
        select c.*  from cat c
    </select>
</mapper>